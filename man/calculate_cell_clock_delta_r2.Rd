% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calculate_cell_clock_delta_r2.R
\name{calculate_cell_clock_delta_r2}
\alias{calculate_cell_clock_delta_r2}
\title{Calculate Delta R-squared for Each Clock, With and Without Cells}
\usage{
calculate_cell_clock_delta_r2(
  data,
  study,
  cell_types,
  all_clocks,
  age_column,
  stratify_by = NULL,
  control_covariates = NULL,
  output_dir = NULL,
  save_results = FALSE
)
}
\arguments{
\item{data}{A data frame containing cell types, clock measures, age, and optional
stratification variables and control covariates.}

\item{study}{A character string specifying the study name, used for naming output files.}

\item{cell_types}{A character vector of column names in \code{data} that contain cell type measurements.}

\item{all_clocks}{A character vector of column names in \code{data} that contain clock measurements.}

\item{age_column}{A character string specifying the name of the age column in \code{data}.}

\item{stratify_by}{A character vector of column names in \code{data} to use for stratification.
Default is \code{NULL} (no stratification).}

\item{control_covariates}{A character vector of column names in \code{data} to use as control
covariates in the regression models. Default is \code{NULL} (no control covariates).}

\item{output_dir}{A character string specifying the output directory. If \code{NULL}, the current
working directory is used. Default is \code{NULL.}}

\item{save_results}{Logical; if \code{TRUE}, results are saved as a CSV file. Default is \code{FALSE.}}
}
\value{
A data frame with columns:
\item{Clock_Variable}{Name of the clock measure}
\item{Categorical_Variable}{Name of the stratification variable (if applicable)}
\item{Categorical_Level}{Level of the stratification variable (if applicable)}
\item{R2_no_cells}{R-squared value for the model without cell types}
\item{R2_cells}{R-squared value for the model with cell types}
\item{Delta_R2}{Difference between R2_cells and R2_no_cells}
\item{n_obs}{Number of observations used in the model}
}
\description{
This function calculates the change in R-squared (delta R2) when adding
cell types to models predicting age-adjusted clock measures. It can stratify
results by categorical variables and control for specified covariates.
}
\examples{
\dontrun{
result <- calculate_cell_clock_delta_r2(
  data = my_data,
  study = "aging_study",
  cell_types = c("Neutrophils", "Monocytes"),
  all_clocks = c("GrimAge", "PhenoAge"),
  age_column = "Age",
  stratify_by = c("Sex", "SmokingStatus"),
  control_covariates = c("BMI", "Batch"),
  save_results = TRUE
)
}

}
